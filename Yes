local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local RootPart = Character:WaitForChild("HumanoidRootPart")

-- Save original CFrame (position + rotation)
getgenv().OldPos = RootPart.CFrame
getgenv().FPDH = workspace.FallenPartsDestroyHeight

-- Function to fling character by applying force and rotation
local function FlingCharacter()
	-- Disable seated state to avoid conflicts
	Humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, false)

	-- Prevent falling out of the world by raising destroy height to infinity
	workspace.FallenPartsDestroyHeight = math.huge

	-- Create BodyVelocity to apply extreme force for fling
	local BV = Instance.new("BodyVelocity")
	BV.Name = "EpixVel"
	BV.Velocity = Vector3.new(9e8, 9e8, 9e8) -- Extreme velocity
	BV.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
	BV.Parent = RootPart

	task.wait(1) -- Duration of fling

	-- Cleanup fling effects
	BV:Destroy()
	Humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, true)

	-- Reset camera to follow the humanoid
	workspace.CurrentCamera.CameraSubject = Humanoid

	-- Restore player position and orientation using CFrame
	repeat
		-- Slight offset upwards (0.5 studs) for safety above ground
		local restoreCFrame = getgenv().OldPos * CFrame.new(0, 0.5, 0)

		-- Set RootPart and Character to restore position and rotation
		RootPart.CFrame = restoreCFrame
		Character:SetPrimaryPartCFrame(restoreCFrame)

		-- Wake up the humanoid if falling or down
		Humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)

		-- Zero out velocities of all parts for a clean stop
		for _, part in ipairs(Character:GetChildren()) do
			if part:IsA("BasePart") then
				part.Velocity = Vector3.zero
				part.RotVelocity = Vector3.zero
			end
		end

		task.wait()
	until (RootPart.Position - getgenv().OldPos.Position).Magnitude < 25

	-- Restore original FallenPartsDestroyHeight
	workspace.FallenPartsDestroyHeight = getgenv().FPDH
end

-- Run the fling function
FlingCharacter()
